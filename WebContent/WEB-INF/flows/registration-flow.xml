<?xml version="1.0" encoding="UTF-8"?>

<flow xmlns="http://www.springframework.org/schema/webflow"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/webflow
        http://www.springframework.org/schema/webflow/spring-webflow-2.0.xsd">


	<var name="patient" class="dao.Patient" />

	<var name="patientsService" class="service.PatientsService" />
	
	<var name="doctor" class="dao.Doctor" />

	<var name="doctorsService" class="service.DoctorsService" />

	<view-state id="create-new-account">

		<transition on="go-to-doctors-registration-form" to="doctors-registration-form"></transition>

		<transition on="go-to-patients-registration-form" to="patients-registration-form"></transition>

	</view-state>



	<view-state id="doctors-registration-form" model="doctor">

		<transition on="submit-registration" to="choose-schedule"></transition>

	</view-state>
	
	<action-state id="creatingDoctor">
		<evaluate expression="doctorsService.createDoctor(doctor)"></evaluate>
		<!-- <evaluate expression="doctorsService.createDoctor(doctor)"></evaluate> -->
		<transition to="registration-completed"></transition>
	</action-state>

	<view-state id="choose-schedule" model="doctor">

		<transition on="schedule-is-choosen" to="creatingDoctor"></transition>

	</view-state>




	<view-state id="patients-registration-form" model="patient">

		<transition on="submit-registration" to="creatingPatient"></transition>

	</view-state>

	<action-state id="creatingPatient">
		<evaluate expression="patientsService.createPatient(patient)"></evaluate>
		<transition to="registration-completed"></transition>
	</action-state>


	<view-state id="registration-completed">

	</view-state>
















</flow>